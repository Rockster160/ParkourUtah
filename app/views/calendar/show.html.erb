<%= javascript_tag do %>
  window.set_date = '<%= @date %>'
<% end %>
<% content_for :body do %>
  <style>
    html, body { background: black; }
  </style>
<% end %>

<% events = [] %>
<div class="row relative">
  <div class="full-calendar-container">
    <div class="calendar-controls col-md-8 col-md-offset-2 col-xs-12 text-center">
      <select class="select-dropbox class-name-search col-sm-4 col-sm-offset-0 col-xs-6 col-xs-offset-3" multiple="multiple" placeholder="All Events(Default)">
        <% @classes.each do |class_name| %>
          <option value="<%= class_name %>"><%= class_name.capitalize %></option>
        <% end %>
      </select>
      <span class="date-controller col-sm-4 col-sm-offset-0 col-xs-10 col-xs-offset-1">
        <%= link_to calendar_draw_path(date: @date - 4.weeks), class: "btn btn-default back-month" do %>
          <%= icon('chevron-left', '', class: '') %>
        <% end %>
        <span class="date-holder"><%= "#{@date.strftime("%B")} #{@date.year}" %></span>
        <%= link_to calendar_draw_path(date: @date + 4.weeks), class: "btn btn-default forward-month" do %>
          <%= icon('chevron-right', '', class: '') %>
        <% end %>
      </span>
      <select class="select-dropbox city-name-search col-sm-4 col-sm-offset-0 col-xs-6 col-xs-offset-3" multiple="multiple" placeholder="All Cities(Default)">
        <% @cities.each do |city| %>
          <option value="<%= city %>"><%= city.capitalize %></option>
        <% end %>
      </select>
    </div>
    <div class="col-md-8 col-md-offset-2 col-xs-12 text-center calendar-container">
      <%= render partial: 'display', locals: {events: events} %>
    </div>
  </div>


<% events.each do |event| %>
  <div class="central-container modal-dialog">
  <div class="modal fade" id="city<%= event.id %>_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="central-container modal-dialog pkut-box">
      <button type="button" class="close-btn contact-close" data-dismiss="modal" aria-hidden="true"><%= icon("times-circle-o", '', class: 'fa-2x') %></button>
      <h3 class="pkut-header"><%= event.class_name.capitalize %></h3>
      <div class="relative">
        <% spot = event.spot_events.first.spot if event.spot_events.first %>
        <% if spot %>
          <p>Spot: <br/> <%= link_to  "#{spot.title} (Click/tap for more details)", spot_path(spot) %></p>
          <p><%= spot.location %></p>
        <% else %>
          <p><%= event.address %></p>
        <% end %>
        <p><%= event.date.strftime('%l:%M %p') %></p>
        <p><%=  %></p>
        <p><%= event.description %></p>
        <p><%=  %></p>
        <p>Instructor: <%= event.host %></p>
        <p>
          <% if current_user %>
            <% unless current_user.is_subscribed_to?(event) %>
              <%= link_to 'Click to receive text alerts for this event.', subscribe_path(id: event.id), class: "calendar-link", method: :post %><br/>
            <% else %>
              <%= link_to 'Unsubscribe from this Event', unsubscribe_path(id: event.id), class: "calendar-link", method: :delete %><br/>
            <% end %>
          <% end %>
        </p>
        <% if current_user && current_user.is_mod? %>
          </br>
          <p><%= link_to 'Edit Event', edit_event_path(id: event.id), class: "calendar-link" %></p>
          <p><%= link_to 'Destroy Event', destroy_event_path(id: event.id), method: :delete, class: "calendar-link", data: {confirm: "Are you sure?"} %></p>
          <p><%= link_to 'Destroy all future occurrences', destroy_event_path(future: "all", id: event.id), method: :delete, class: "calendar-link",
          data:{confirm: "Are you sure? This will delete this and all future events tied to this one."} if event.token %></p>
        <% end %>
      </div>
    </div>
  </div>
<% end %>
