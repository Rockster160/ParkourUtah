var ready = function() {

  $('.cart-container').delegate('.fake-stripe-btn', 'click', function(e) {
    if ($('.shopping-cart-total-holder').html() != "$0.00") {
      $('.modal').modal('hide');
      $('.stripe-button-el').click()
      e.preventDefault();
      return false
    }
  });

  $('.cart-container').delegate('.shopping-cart-line-item-quantity-input', 'focusin', function() {
    amount_holder = $(this).val();
  });

  $('.cart-container').delegate('.delete-x', 'click', function() {
    $(this).siblings('.shopping-cart-line-item-quantity').children().val(0)
    sendUpdatedAmount($(this).attr('id'), 0);
  });

  $('.cart-container').delegate('.delete-all-transactions', 'click', function() {
    $.post('/cart/update', {delete_all: true});
    return false;
  });

  $('.cart-container').delegate('.shopping-cart-line-item-quantity-input', 'focusout', function() {
    if ($(this).val() != amount_holder) {
      sendUpdatedAmount($(this).attr('id'), $(this).val());
    }
  });

};

$('.scrollTop').ready(function() {
  $('body, html').animate({scrollTop:0},300);
});

sendUpdatedAmount = function(item_name, new_amount) {
  $.post('/cart/update', {item_name: item_name, new_amount: new_amount});
}

$(document).ready(ready);
$(document).on('page:load', ready);
